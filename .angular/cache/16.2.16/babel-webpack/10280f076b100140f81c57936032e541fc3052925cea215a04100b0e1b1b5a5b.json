{"ast":null,"code":"import { Weekly } from 'src/app/shared/models/weekly.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/shared/services/http.service\";\nimport * as i2 from \"src/app/shared/services/davening.service\";\nimport * as i3 from \"../../admin.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"../../../select-davenfors/select-davenfors.component\";\nfunction WeeklyComponent_div_11_option_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const p_r12 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", p_r12.englishName, \" - \", p_r12.hebrewName, \"\");\n  }\n}\nfunction WeeklyComponent_div_11_option_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const c_r13 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\"\", c_r13.englishName, \" - \", c_r13.hebrewName, \"\");\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    emphasized: a0\n  };\n};\nfunction WeeklyComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 19)(2, \"div\", 20)(3, \"input\", 21, 22);\n    i0.ɵɵlistener(\"change\", function WeeklyComponent_div_11_Template_input_change_3_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const _r5 = i0.ɵɵreference(8);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.weekChange(_r5.value));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"label\", 23);\n    i0.ɵɵtext(6, \"Parasha name:\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"select\", 24, 25);\n    i0.ɵɵlistener(\"ngModelChange\", function WeeklyComponent_div_11_Template_select_ngModelChange_7_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r16.parasha = $event);\n    })(\"change\", function WeeklyComponent_div_11_Template_select_change_7_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const _r4 = i0.ɵɵreference(4);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.updateWeekName(_r4.checked, $event.target.value));\n    });\n    i0.ɵɵtemplate(9, WeeklyComponent_div_11_option_9_Template, 2, 2, \"option\", 26);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"div\", 19)(11, \"div\", 20)(12, \"input\", 27, 28);\n    i0.ɵɵlistener(\"change\", function WeeklyComponent_div_11_Template_input_change_12_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const _r8 = i0.ɵɵreference(17);\n      const ctx_r18 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r18.weekChange(_r8.value));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"label\", 29);\n    i0.ɵɵtext(15, \"Special week: \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(16, \"select\", 30, 31);\n    i0.ɵɵlistener(\"change\", function WeeklyComponent_div_11_Template_select_change_16_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const _r7 = i0.ɵɵreference(13);\n      const ctx_r19 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r19.updateWeekName(_r7.checked, $event.target.value));\n    })(\"ngModelChange\", function WeeklyComponent_div_11_Template_select_ngModelChange_16_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r20 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r20.chag = $event);\n    });\n    i0.ɵɵtemplate(18, WeeklyComponent_div_11_option_18_Template, 2, 2, \"option\", 26);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(19, \"div\", 19)(20, \"div\", 20)(21, \"input\", 32, 33);\n    i0.ɵɵlistener(\"change\", function WeeklyComponent_div_11_Template_input_change_21_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const _r11 = i0.ɵɵreference(26);\n      const ctx_r21 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r21.weekChange(_r11.value));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"label\", 34);\n    i0.ɵɵtext(24, \"Other: \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(25, \"input\", 35, 36);\n    i0.ɵɵlistener(\"keyup\", function WeeklyComponent_div_11_Template_input_keyup_25_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const _r10 = i0.ɵɵreference(22);\n      const ctx_r22 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r22.updateWeekName(_r10.checked, $event.target.value));\n    })(\"ngModelChange\", function WeeklyComponent_div_11_Template_input_ngModelChange_25_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r23 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r23.customWeek = $event);\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const _r4 = i0.ɵɵreference(4);\n    const _r7 = i0.ɵɵreference(13);\n    const _r10 = i0.ɵɵreference(22);\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(8, _c0, _r4.checked));\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.parasha);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.parashot);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(10, _c0, _r7.checked));\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.chag);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.adminService.chagim);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(12, _c0, _r10.checked));\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.customWeek);\n  }\n}\nfunction WeeklyComponent_option_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 37);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const c_r24 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", c_r24);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\"\", c_r24.english, \" -\", c_r24.hebrew, \" \");\n  }\n}\nfunction WeeklyComponent_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r26 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 38)(1, \"input\", 39);\n    i0.ɵɵlistener(\"ngModelChange\", function WeeklyComponent_div_25_Template_input_ngModelChange_1_listener($event) {\n      i0.ɵɵrestoreView(_r26);\n      const ctx_r25 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r25.adminPassword = $event);\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r2.adminPassword);\n  }\n}\nfunction WeeklyComponent_div_26_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r28 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"button\", 40);\n    i0.ɵɵlistener(\"click\", function WeeklyComponent_div_26_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r27 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r27.verify());\n    });\n    i0.ɵɵtext(2, \"Ok\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport let WeeklyComponent = /*#__PURE__*/(() => {\n  class WeeklyComponent {\n    constructor(httpService, daveningService, adminService) {\n      this.httpService = httpService;\n      this.daveningService = daveningService;\n      this.adminService = adminService;\n      this.customWeek = \"\";\n      this.changeParasha = false;\n      this.selectedDavenfors = [];\n      this.disablePreview = false; //will turn to true only if selectedDavenfors proves to be empty. \n      this.message = \"\";\n      this.askForPassword = false; //This will show only when admin clicks send, one last verification.\n      this.adminPassword = \"\";\n    }\n    ngOnInit() {\n      this.askForPassword = false;\n      this.adminPassword = \"\";\n      this.davenfors = this.adminService.davenfors;\n      this.adminService.populateParashot();\n      this.parashot = this.adminService.getParashot();\n      this.adminService.populateWeeklyCategory();\n      this.weeklyCategory = this.adminService.getWeeklyCategory();\n      this.selectedCategory = this.weeklyCategory;\n      this.davenforsChangedSub = this.adminService.davenforsChanged.subscribe(updatedList => {\n        this.davenfors = updatedList;\n        this.refreshDavenfors();\n      });\n      let currentParashaId = this.adminService.currentParasha.id;\n      this.parasha = this.parashot[currentParashaId];\n      this.chagim = this.adminService.chagim;\n      this.chag = this.chagim[0];\n      this.weekName = this.parasha.englishName + \" - \" + this.parasha.hebrewName;\n      this.refreshDavenfors();\n    }\n    weekChange(value) {\n      this.weekName = value;\n    }\n    updateWeekName(isRelevant, newWeekName) {\n      if (isRelevant) {\n        this.weekName = newWeekName;\n      }\n    }\n    toggleChangeParasha(value) {\n      this.changeParasha = !this.changeParasha;\n    }\n    refreshDavenfors() {\n      this.disablePreview = false; //start again.  Maybe list now has something. \n      this.selectedDavenfors = []; //clean array to populate newly\n      this.davenfors.forEach(davenfor => {\n        if (davenfor.category.english == this.selectedCategory.english) {\n          //specifying english name in case object isn't exactly identical\n          this.selectedDavenfors.push(davenfor);\n        }\n      });\n      if (this.selectedDavenfors.length < 1) {\n        //difficulty binding 'disable' to preview button.  Using boolean variable instead.\n        this.disablePreview = true;\n      }\n    }\n    send() {\n      let weeklyInfo = new Weekly(this.parasha.englishName, this.weekName, this.selectedCategory.id, this.message);\n      this.adminService.sendWeekly(weeklyInfo);\n    }\n    preview() {\n      if (this.selectedDavenfors.length < 1) {}\n      let weeklyInfo = new Weekly(this.parasha.englishName, this.weekName, this.selectedCategory.id, this.message);\n      this.adminService.previewList(weeklyInfo);\n    }\n    verify() {\n      const weeklyInfo = new Weekly(this.parasha.englishName, this.weekName, this.selectedCategory.id, this.message);\n      this.adminService.verify(weeklyInfo, this.adminPassword);\n    }\n    requestToSend() {\n      this.askForPassword = true;\n    }\n    ngOnDestroy() {\n      if (this.davenforsChangedSub) this.davenforsChangedSub.unsubscribe();\n    }\n    static #_ = this.ɵfac = function WeeklyComponent_Factory(t) {\n      return new (t || WeeklyComponent)(i0.ɵɵdirectiveInject(i1.HttpService), i0.ɵɵdirectiveInject(i2.DaveningService), i0.ɵɵdirectiveInject(i3.AdminService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: WeeklyComponent,\n      selectors: [[\"app-weekly\"]],\n      decls: 30,\n      vars: 12,\n      consts: [[1, \"container\"], [1, \"row\"], [1, \"col-xs-4\"], [1, \"col-xs-2\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"col-xs-6\"], [\"placeholder\", \"Enter a message to be sent to all list recipients (optional)\", \"rows\", \"2\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [4, \"ngIf\"], [1, \"col-xs-3\"], [1, \"form-control\", \"set-width\", 3, \"ngModel\", \"ngModelChange\"], [3, \"ngValue\", 4, \"ngFor\", \"ngForOf\"], [1, \"col-xs-1\", \"col-xs-offset-1\"], [1, \"btn\", \"btn-warning\", \"btn-lg\", 3, \"disabled\", \"click\"], [1, \"col-xs-1\"], [1, \"btn\", \"btn-success\", \"btn-lg\", 3, \"click\"], [\"class\", \"col-xs-2 col-xs-offset-1\", 4, \"ngIf\"], [\"class\", \"col-xs-1\", 4, \"ngIf\"], [1, \"div-names\"], [3, \"davenfors\", \"category\", \"adminPermission\"], [1, \"col-xs-3\", 3, \"ngClass\"], [1, \"custom-control\", \"custom-radio\"], [\"type\", \"radio\", \"checked\", \"\", \"id\", \"radioParashaId\", \"name\", \"weekType\", 1, \"custom-control-input\", \"give-space\", 3, \"change\"], [\"radioParasha\", \"\"], [\"for\", \"radioParasha\", 1, \"custom-control-label\"], [1, \"set-width\", \"form-control\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [\"parashaTag\", \"\"], [4, \"ngFor\", \"ngForOf\"], [\"type\", \"radio\", \"id\", \"radioChag\", \"name\", \"weekType\", 1, \"custom-control-input\", \"give-space\", 3, \"change\"], [\"radioChag\", \"\"], [\"for\", \"radioChag\", 1, \"custom-control-label\"], [1, \"form-control\", \"set-width\", 3, \"ngModel\", \"change\", \"ngModelChange\"], [\"chagTag\", \"\"], [\"type\", \"radio\", \"id\", \"radioCustom\", \"name\", \"weekType\", 1, \"custom-control-input\", \"give-space\", 3, \"change\"], [\"radioCustom\", \"\"], [\"for\", \"radioCustom\", 1, \"custom-control-label\"], [\"placeholder\", \"Enter week title\", \"type\", \"text\", 1, \"form-control\", \"set-width\", 3, \"ngModel\", \"keyup\", \"ngModelChange\"], [\"customTag\", \"\"], [3, \"ngValue\"], [1, \"col-xs-2\", \"col-xs-offset-1\"], [\"type\", \"password\", \"placeholder\", \"Enter admin password\", 1, \"form-control\", \"red-font\", 3, \"ngModel\", \"ngModelChange\"], [1, \"btn\", \"btn-success\", 3, \"click\"]],\n      template: function WeeklyComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"h4\");\n          i0.ɵɵtext(4);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(5, \"div\", 3)(6, \"button\", 4);\n          i0.ɵɵlistener(\"click\", function WeeklyComponent_Template_button_click_6_listener() {\n            return ctx.toggleChangeParasha(ctx.weekType);\n          });\n          i0.ɵɵtext(7);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(8, \"div\", 5)(9, \"textarea\", 6);\n          i0.ɵɵlistener(\"ngModelChange\", function WeeklyComponent_Template_textarea_ngModelChange_9_listener($event) {\n            return ctx.message = $event;\n          });\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(10, \"div\", 1);\n          i0.ɵɵtemplate(11, WeeklyComponent_div_11_Template, 27, 14, \"div\", 7);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(12, \"div\", 1)(13, \"div\", 8)(14, \"h4\");\n          i0.ɵɵtext(15, \"Category this week: \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(16, \"div\", 3)(17, \"select\", 9);\n          i0.ɵɵlistener(\"ngModelChange\", function WeeklyComponent_Template_select_ngModelChange_17_listener($event) {\n            return ctx.selectedCategory = $event;\n          })(\"ngModelChange\", function WeeklyComponent_Template_select_ngModelChange_17_listener() {\n            return ctx.refreshDavenfors();\n          });\n          i0.ɵɵtemplate(18, WeeklyComponent_option_18_Template, 2, 3, \"option\", 10);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(19, \"div\", 11)(20, \"button\", 12);\n          i0.ɵɵlistener(\"click\", function WeeklyComponent_Template_button_click_20_listener() {\n            return ctx.preview();\n          });\n          i0.ɵɵtext(21, \"Preview\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(22, \"div\", 13)(23, \"button\", 14);\n          i0.ɵɵlistener(\"click\", function WeeklyComponent_Template_button_click_23_listener() {\n            return ctx.requestToSend();\n          });\n          i0.ɵɵtext(24, \"Send List\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(25, WeeklyComponent_div_25_Template, 2, 1, \"div\", 15);\n          i0.ɵɵtemplate(26, WeeklyComponent_div_26_Template, 3, 0, \"div\", 16);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(27, \"hr\");\n          i0.ɵɵelementStart(28, \"div\", 17);\n          i0.ɵɵelement(29, \"app-select-davenfors\", 18);\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(4);\n          i0.ɵɵtextInterpolate1(\"Week of: \", ctx.weekName, \"\");\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate(ctx.changeParasha ? \"Save\" : \"Change\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngModel\", ctx.message);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.changeParasha);\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngModel\", ctx.selectedCategory);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngForOf\", ctx.adminService.categories);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"disabled\", ctx.disablePreview);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ctx.askForPassword);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.askForPassword);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"davenfors\", ctx.selectedDavenfors)(\"category\", ctx.selectedCategory.english)(\"adminPermission\", true);\n        }\n      },\n      dependencies: [i4.NgClass, i4.NgForOf, i4.NgIf, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i5.DefaultValueAccessor, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.NgModel, i6.SelectDavenforsComponent],\n      styles: [\".give-space[_ngcontent-%COMP%]{margin-right:5px}.row[_ngcontent-%COMP%]{margin-bottom:10px}.set-width[_ngcontent-%COMP%]{width:205px}select[_ngcontent-%COMP%]{margin-bottom:10px}.emphasized[_ngcontent-%COMP%]{border-style:inset;border-color:var(--dark-background-color);border-width:2px}.div-names[_ngcontent-%COMP%]{max-height:320px;overflow:auto}.same-line[_ngcontent-%COMP%]{display:inline-block!important;margin-top:0}\"]\n    });\n  }\n  return WeeklyComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}